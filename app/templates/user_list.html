{% extends "base.html" %}
{% block content %}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <h2>User Management</h2>
    <a href="/users/new" class="btn">➕ Add User</a>
</div>

<table class="table">
    <thead>
        <tr>
            <th>Username</th>
            <th>Full Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Status</th>
            <th>Last Login</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.username }}</td>
            <td>{{ user.full_name or '—' }}</td>
            <td>{{ user.email }}</td>
            <td>
                {% if user.is_admin %}
                    <span class="pill" style="background: #8b5cf6; color: white;">Admin</span>
                {% else %}
                    <span class="pill">User</span>
                {% endif %}
            </td>
            <td>
                {% if user.is_active %}
                    <span class="pill pill-tag">Active</span>
                {% else %}
                    <span class="pill" style="background: #666; color: white;">Inactive</span>
                {% endif %}
            </td>
            <td>{{ user.last_login.strftime('%Y-%m-%d %H:%M') if user.last_login else 'Never' }}</td>
            <td>
                {% if user.id != current_user.id %}
                <form method="post" action="/users/{{ user.id }}/toggle-active" style="display: inline;">
                    <button type="submit" class="btn btn-small">
                        {% if user.is_active %}Disable{% else %}Enable{% endif %}
                    </button>
                </form>
                <form method="post" action="/users/{{ user.id }}/delete" style="display: inline;" 
                      onsubmit="return confirm('Are you sure you want to delete this user?');">
                    <button type="submit" class="btn btn-small" style="background: #dc3545;">Delete</button>
                </form>
                {% else %}
                <span style="color: #999; font-size: 0.85em;">(You)</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<style>
.pill {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 999px;
    background: #eef2ff;
    color: #3730a3;
    font-size: 12px;
    font-weight: 500;
}
</style>

{% endblock %}