{% extends "base.html" %}
{% block title %}My Profile - JSN Holdings{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">My Profile</h1>
    <p class="page-subtitle">Manage your account settings and security.</p>
</div>

{% if error %}
<div class="alert alert-danger">{{ error }}</div>
{% endif %}

{% if success %}
<div class="alert alert-success">{{ success }}</div>
{% endif %}

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); max-width: 1000px;">
    <!-- Account Information -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Account Information</h3>
        </div>
        <div class="card-body">
            <div style="display: flex; align-items: center; gap: var(--space-lg); margin-bottom: var(--space-xl); padding-bottom: var(--space-lg); border-bottom: 1px solid var(--border);">
                <div style="width: 80px; height: 80px; background: var(--gradient); border-radius: var(--radius-full); display: flex; align-items: center; justify-content: center; color: white; font-size: 32px; font-weight: 700;">
                    {{ (user.full_name or user.username or 'U')[0]|upper }}
                </div>
                <div>
                    <div style="font-size: 20px; font-weight: 700; color: var(--text);">{{ user.full_name or user.username }}</div>
                    <div style="color: var(--text-secondary);">{{ user.email }}</div>
                    <span class="badge {% if user.is_admin %}badge-primary{% else %}badge-neutral{% endif %}" style="margin-top: var(--space-sm);">
                        {% if user.is_admin %}Administrator{% else %}User{% endif %}
                    </span>
                </div>
            </div>
            
            <div style="display: grid; gap: var(--space-md);">
                <div style="display: flex; justify-content: space-between; padding: var(--space-sm) 0; border-bottom: 1px solid var(--border-light);">
                    <span style="color: var(--text-secondary);">Username</span>
                    <span style="font-weight: 500;">{{ user.username }}</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: var(--space-sm) 0; border-bottom: 1px solid var(--border-light);">
                    <span style="color: var(--text-secondary);">Email</span>
                    <span style="font-weight: 500;">{{ user.email }}</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: var(--space-sm) 0; border-bottom: 1px solid var(--border-light);">
                    <span style="color: var(--text-secondary);">Full Name</span>
                    <span style="font-weight: 500;">{{ user.full_name or '—' }}</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: var(--space-sm) 0; border-bottom: 1px solid var(--border-light);">
                    <span style="color: var(--text-secondary);">Account Created</span>
                    <span style="font-weight: 500;">{{ user.created_at.strftime('%B %d, %Y') if user.created_at else '—' }}</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: var(--space-sm) 0;">
                    <span style="color: var(--text-secondary);">Last Login</span>
                    <span style="font-weight: 500;">{{ user.last_login.strftime('%B %d, %Y at %I:%M %p') if user.last_login else 'Never' }}</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Change Password -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Change Password</h3>
        </div>
        <div class="card-body">
            <form method="post" action="/profile/change-password">
                <div class="form-group">
                    <label class="form-label">Current Password *</label>
                    <input type="password" name="current_password" required class="form-control">
                </div>
                
                <div class="form-group">
                    <label class="form-label">New Password *</label>
                    <input type="password" name="new_password" required minlength="8" placeholder="Minimum 8 characters" class="form-control">
                    <span class="form-hint">Must be at least 8 characters long.</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Confirm New Password *</label>
                    <input type="password" name="confirm_password" required minlength="8" class="form-control">
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">Update Password</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
